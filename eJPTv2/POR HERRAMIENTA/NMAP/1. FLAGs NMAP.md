Es una herramienta con mucha potencia y alcance, a continuación se muestran varias "flags" que son útiles a nivel de escaneo de puertos, escaneo de red/equipos y búsqueda de vulnerabilidades.

# Flag -sS (SYN Scan)
La “flag” en Nmap se utiliza para realizar un "TCP SYN scan", que es un método de escaneo de puertos. Este tipo de escaneo es muy eficiente porque <span style="color:rgb(255, 192, 0)">envía un paquete SYN (solicitud de conexión) a cada puerto objetivo y analiza la respuesta para determinar si el puerto está abierto, cerrado o filtrado.</span>

Algunas posibles respuestas son:

- Puerto Abierto: Si el puerto está abierto, el sistema objetivo responderá con un paquete SYN-ACK, que indica que está dispuesto a establecer una conexión.
- Puerto Cerrado: Si el puerto está cerrado, se responderá con un paquete RST (reset), que indica que no hay un servicio escuchando en ese puerto.
- Filtrado: Si hay un firewall o algún tipo de filtrado de paquetes en el camino, es posible que no se reciba respuesta, lo que puede indicar que el puerto está filtrado.

Este escaneo es menos detectable por sistemas de detección que el -sT que veremos a continuación.

![[1.1. NMAP.png]]

![[1.2. NMAP.png]]

Como se puede apreciar en las imágenes se trata de un escaneo el cual lanza paquetes a cada uno de los puertos con una frecuencia de T3 por lo que llega a hacer bastante ruido en caso de que alguna aplicación estuviera monitorizando.
# Flag -sT (TCP Scan)

Esta “flag” es similar a la anterior simplemente se utiliza para realizar un <span style="color:rgb(255, 192, 0)">escaneo de puertos TCP completo</span> conocido como "TCP Connect Scan". Esta técnica es una de las formas más básicas de escanear puertos y se basa en la capacidad del sistema operativo para establecer conexiones TCP. 

En esta conexión si el puerto está abierto, el sistema objetivo responde la solicitud con un SYN-ACK, en ese momento el escáner envía el paquete RST para finalizar la conexión sin llegar a establecer la conexión completa. 

Como ventajas al anterior vemos que es fácil de implementar y no requiere privilegios elevados, en su contra tenemos que es bastante ruidoso y fácil de detectar en la red.

![[1.3 NMAP 1.png]]

![[1.4. NMAP 1.png]]


# Flag -sA (ACK SCAN)

Con esta “flag” lo que se pretende es <span style="color:rgb(255, 192, 0)">detectar la presencia de un Firewall o sistema de filtrado</span> de paquetes entre el host que escanea y el objetivo. 

El funcionamiento es el siguiente, NMAP envía paquetes TCP con el “flag” ACK a los puertos destinos marcados, la respuesta puede ser RST si el puerto no está filtrado o nula.

![[1.5. NMAP 1.png]]



# Flag -sU (UDP Scan)
Esta es una técnica que se utiliza para <span style="color:rgb(255, 192, 0)">escanear puertos UDP</span> en un objetivo. A diferencia de los puertos TCP, los puertos UDP no requieren establecer una conexión (no hay "handshake" como en TCP), lo que hace que este tipo de escaneo sea más lento y menos confiable, pero esencial para identificar servicios UDP. 

Las respuestas esperadas son:
- Puerto abierto: No genera ninguna respuesta especifica.
- Puerto cerrado: Se recibe un paquete ICMP.
- Puerto Filtrado: ni respuesta ni paquete ICMP.

![[1.6. NMAP 1.png]]

![[1.7. NMAP 1.png]]


# Flag -sV (Service SCAN)

Mediante esta “flag” podemos <span style="color:rgb(255, 192, 0)">obtener información sobre los servicios que estén alojados en los puertos indicados en el NMAP</span>, es una de las “flags” más útiles debido a que <span style="color:rgb(255, 192, 0)">a raíz de esto se pueden buscar las vulnerabilidades del servicio/versión</span> de servicio indicadas en el resultado.

![[1.8. NMAP 1.png]]

![[1.9. NMAP 1.png]]


# Flag –top-ports

Esta “flag” se utiliza para <span style="color:rgb(255, 192, 0)">escanear un número limitado de los puertos más comunes</span> según estadísticas recopiladas por NMAP, esto permite realizar un<span style="color:rgb(255, 192, 0)"> escaneo rápido y centrado en puertos que tienen una mayor probabilidad de tener servicios</span> o encontrarse abiertos en un sistema.

![[1.10. NMAP 1.png]]

![[1.11. NMAP 1.png]]


# -O (OS SCAN)
Este escaneo intenta identificar el sistema operativo que se está ejecutando en el host objetivo, basándose en técnicas de análisis de paquetes y huellas digitales. 

Mediante este escaneo NMAP diferencia (normalmente) muy bien entre “ttls”, teniendo el resultado en cuenta del “ttl” podríamos determinar, siempre y cuando este por defecto, que un <span style="color:rgb(255, 192, 0)">“ttl=128” correspondería a una máquina Windows</span> y un <span style="color:rgb(255, 192, 0)">“ttl=64” sería el resultado para Linux.</span>

![[1.12. NMAP 1.png]]


# Flag -A

Se trata de un <span style="color:rgb(255, 192, 0)">escaneo</span><span style="color:rgb(255, 192, 0)"> de NMAP</span> <span style="color:rgb(255, 192, 0)">de forma agresiva mediante la utilización de Scripts</span> que tiene configurados de forma predeterminada para lanzarlos contra los puertos que se queden indicados en la ejecución del comando.

![[1.13. NMAP 1.png]]