Es de gran importancia siempre hacer revisión de los códigos fuentes de las páginas con tal de revisar si existe o no algún mensaje importante. En este caso, nos encontrábamos un comentario indicando una dirección de un archivo:

![[1. LOCAL FILE INCLUSION.png]]

Ver una URL con esta estructura es un indicio de que quizás podamos hacer Local File Inclusion ya que hace la llamada de un "doc". 

Para hacer el ataque consiste en cambiar el contenido posterior al = para navegar entre los directorios.

Como primera prueba si podemos o no hacer este tipo de ataque tendríamos que modificar de la siguiente forma el dominio.

````
192.168.0.23/tools/check_if_exist.php?doc=../../../../../../../../../etc/passwd
`````

Mediante esto entraremos al archivo `passwd` y comprobaremos si funciona o no. Dentro de este archivo siempre que veamos un usuario precedido de un directorio "/home/" significará que existe.

Teniendo este usuario podemos acceder al siguiente directorio:

````
192.168.0.23/tools/check_if_exist.php?doc=../../../../../../../../../home/gh0st/.ssh/id_rsa
`````

Este archivo vendrá encriptado, mediante "ctrl + U" podremos conseguir una vista mas limpia.

Copiaremos todo el texto y lo pegaremos en nuestro escritorio con el mismo nombre de archivo. Tendremos que darle unos permisos concretos al archivo para eso usaremos el comando: 

````
chmod 600 id_rsa
`````

Con este archivo podremos acceder de forma SSH a la máquina sin uso de contraseña siempre y cuando sepamos el usuario.

Se haría con el siguiente comando 

````
ssh -i id_rsa gh0st@192.169.0.23
`````

Nos pedirá un salvoconducto para el uso del archivo.

Mediante la herramienta JohnTheRipper podremos crackear el archivo con los siguientes comandos:

- Preparamos el hash del archivo.
````
ssh2john id_rsa > hash
`````

- Crackear el hash del archivo:
````
john --wordlist=/usr/share/wordlist/rockyou.txt hash
`````

Esto nos devolverá el salvoconducto necesario para poder hacer uso del archivo para la conexión.






